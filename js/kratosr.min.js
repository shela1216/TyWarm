let kr={};window.requestIdleCallback=window.requestIdleCallback||function(e){let t=Date.now();return setTimeout((function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-t))}})}),1)},window.cancelIdleCallback=window.cancelIdleCallback||function(e){clearTimeout(e)},(()=>{const e=()=>{$(document).on("click",".xHeading",(function(e){$(this).next().slideToggle(300),$(this).parent(".xControl").hasClass("active")?$(this).parent(".xControl").removeClass("active"):$(this).parent(".xControl").addClass("active"),e.preventDefault()}))},t=()=>{void 0!==$.fancybox&&($.fancybox.defaults.hash=!1,$(".kratos-hentry").each((function(e){$(this).find("img").each((function(){if($(this).parent().hasClass("fancybox")||$(this).parent().hasClass("qrcode")||$(this).parent().is("a"))return;const e=this.alt;e&&$(this).after('<span class="caption">'+e+"</span>"),$(this).wrap('<a rel="gallery" href="'+this.src+'" data-fancybox="gallery" data-caption="'+e+'"></a>')}))})),$(".fancybox").fancybox())},n=()=>{$(document).on("click","a[class=toc-link]",(function(){return $("html, body").animate({scrollTop:$(decodeURI($(this).attr("href"))).offset().top-60},500),!1}))};let o;let a="";const s=(e,t=!0)=>{let n;const o=e/1e3,a=Math.floor(o/60/60/24),s=Math.floor(o/60/60-24*a),l=Math.floor(o/60-1440*a-60*s),i=Math.floor(o-86400*a-3600*s-60*l);let r=a.toString(),c=s.toString(),d=l.toString(),m=i.toString();return t?(r&&1===r.length&&(r="0"+r),c&&1===c.length&&(c="0"+c),d&&1===d.length&&(d="0"+d),m&&1===m.length&&(m="0"+m),n=r+"天"+c+"小时"+d+"分"+m+"秒"):n=a<540?a<60?r+"天":Math.floor(a/30).toString()+"个月":Math.floor(a/365).toString()+"年",n},l=()=>{(()=>{const e=document.getElementsByClassName("kratos-entry-thumb-new-img");let t=kr.site_root;(kr.picCDN||kr.pic&&kr.pic.CDN)&&(t="//cdn.jsdelivr.net/gh/Candinya/Kratos-Rebirth@latest/source/");let n=20;kr.pic&&parseInt(kr.pic.random_amount)&&(n=parseInt(kr.pic.random_amount));let o="images/thumb/thumb_{no}.webp";kr.pic&&kr.pic.filename&&(o=kr.pic.filename.includes("//")?kr.pic.filename:t+kr.pic.filename);for(let t=0,a=e.length;t<a;t++)if(!$(e[t]).attr("src")){const a=Math.floor(Math.random()*n+1),s=o.replace("{no}",a.toString());$(e[t]).attr("src",s)}})(),t(),o=`\n\n-------------------------\n${kr.copyrightNotice}\n作者：${document.querySelector("meta[name='author']").getAttribute("content")}\n来源：${document.title}\n链接：${window.location.href}\n`,a=document.title,"undefined"!=typeof MathJax&&MathJax.Hub.Typeset(),document.querySelectorAll("figure.highlight").forEach(((e,t)=>{e.getElementsByTagName("table")[0].getElementsByTagName("tbody")[0].getElementsByTagName("tr")[0].getElementsByClassName("code")[0].setAttribute("id",`code-${t}`),e.innerHTML+=`<button class="copy" data-clipboard-target="#code-${t}">\n                <i class="fa fa-copy"></i>&nbsp;复制\n            </button>`})),new ClipboardJS("button.copy").on("success",(e=>{const t=e.trigger.innerHTML;e.trigger.innerHTML='<i class="fa fa-check-circle"></i>&nbsp;成功~',setTimeout((()=>{e.trigger.innerHTML=t}),3e3),e.clearSelection()})),(()=>{const e="undefined"!=typeof window,t=e&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent),n=e&&"IntersectionObserver"in window,o=document.querySelector(".post-comments.lazy-load"),a=()=>{window.loadCommentsEventHandler&&window.cancelIdleCallback(window.loadCommentsEventHandler),window.loadCommentsEventHandler=window.requestIdleCallback(load_comm),load_comm=null};if(e&&!t&&n&&null!==o){const e=new IntersectionObserver((t=>{t[0].isIntersecting&&(a(),e.disconnect())}),{threshold:0});e.observe(o)}else"undefined"!=typeof load_comm&&null!==load_comm&&a()})(),(()=>{if(kr.expire_day){const e=document.getElementById("expire-alert");if(e){const t=e.querySelector("time"),n=new Date(parseInt(t.getAttribute("datetime"))),o=Date.now()-n;o>24*kr.expire_day*3600*1e3&&(t.innerText=s(o,!1),e.classList.remove("hidden"))}}})(),(()=>{if(null!==document.getElementById("krw-toc")){const e=document.getElementsByClassName("toc-item"),t=[];Array.from(e).forEach((e=>{const n=e.getElementsByClassName("toc-link")[0],o=decodeURI(n.getAttribute("href")),a=document.querySelector(o).offsetTop;t.push({h:a,el:e})})),t.sort(((e,t)=>e.h-t.h));const n=(e=-1)=>{let n;n=!Number.isInteger(e)||e<0||e>t.length-1?0:e;const o=window.scrollY;if(t[0].h>o)n=-1;else if(t[t.length-1].h<=o)n=t.length-1;else for(;!(t[n].h<=o&&t[n+1].h>o);)t[n].h>o&&n>0?n--:t[n+1].h<=o&&n<t.length-1&&n++;return n},o=(e,n)=>{if(e!==n){if(-1!==e){t[e].el.classList.remove("active"),t[e].el.classList.remove("show");let n=t[e].el;for(;!n.classList.contains("toc");)n.classList.contains("toc-item")&&n.classList.remove("show"),n=n.parentNode}if(-1!==n){t[n].el.classList.add("active"),t[n].el.classList.add("show");let e=t[n].el;for(;!e.classList.contains("toc");)e.classList.contains("toc-item")&&e.classList.add("show"),e=e.parentNode}}};let a=-1;const s=()=>{const e=n(a);o(a,e),a=e},l=()=>{let e=0;window.requestAnimationFrame((()=>{e&&clearTimeout(e),e=setTimeout((e=>{e===window.scrollY&&s()}),100,window.scrollY)}))};window.addEventListener("scroll",l),s(),window.addEventListener("pjax:before",(()=>{t.length=0,window.removeEventListener("scroll",l)}),{once:!0});const i=document.getElementsByClassName("toc-progress-bar")[0],r=()=>{i.style.width=(window.scrollY/document.body.clientHeight*100).toString()+"%"};window.addEventListener("scroll",(()=>{window.requestAnimationFrame(r)})),r()}})()};window.addEventListener("pjax:complete",l),window.addEventListener("window:onload",(()=>{(()=>{let e=!1;const t=()=>{window.requestAnimationFrame((()=>{window.scrollY>200?e||(document.body.classList.add("scroll-down"),e=!0):e&&(document.body.classList.remove("scroll-down"),e=!1)}))};$(".gotop-box").on("click",(function(e){return $("html, body").animate({scrollTop:$("html").offset().top},500),!1})),t(),window.addEventListener("scroll",t)})(),(()=>{let e=$("#kratos-menu-wrap").clone();e.attr({id:"offcanvas-menu"}),e.filter("> ul").attr({class:"ul-me",id:""}),$("#kratos-page").prepend(e),$(".js-kratos-nav-toggle").on("click",(()=>{$(".nav-toggle").hasClass("toon")?($(".nav-toggle").removeClass("toon"),$("#offcanvas-menu").css("right","-240px")):($(".nav-toggle").addClass("toon"),$("#offcanvas-menu").css("right","0px"))})),$("#offcanvas-menu").css("height",$(window).height()),$("#offcanvas-menu").css("right","-240px"),$(window).resize((()=>{const e=$(window);$("#offcanvas-menu").css("height",e.height()),e.width()>769&&$(".nav-toggle").hasClass("toon")&&($(".nav-toggle").removeClass("toon"),$("#offcanvas-menu").css("right","-240px"))}))})(),$(document).click((e=>{const t=$("#offcanvas-menu,.js-kratos-nav-toggle");t.is(e.target)||0!==t.has(e.target).length||$(".nav-toggle").hasClass("toon")&&($(".nav-toggle").removeClass("toon"),$("#offcanvas-menu").css("right","-240px"))})),e(),$(document).on("click",".share",(()=>{$(".share-wrap").fadeToggle("slow")})),n()}),{once:!0}),window.onload=()=>{window.dispatchEvent(new Event("window:onload")),console.log("页面加载完毕！消耗了 %c"+Math.round(100*performance.now())/100+" ms","background:#282c34;color:#51aded;")}})();
//# sourceMappingURL=../maps/kratosr.min.js.map
